{
  "name": "mcp_http_blackbox_campaign_flow",
  "steps": [
    {
      "name": "initialize",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 1,
        "method": "initialize",
        "params": {
          "protocolVersion": "2024-11-05",
          "clientInfo": {
            "name": "blackbox-client",
            "version": "0.1.0"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 1
      }
    },
    {
      "name": "initialized",
      "expect_status": 204,
      "request": {
        "jsonrpc": "2.0",
        "method": "initialized",
        "params": {}
      }
    },
    {
      "name": "campaign_list_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 2,
        "method": "resources/subscribe",
        "params": {
          "uri": "campaigns://list"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 2
      }
    },
    {
      "name": "campaign_create",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 3,
        "method": "tools/call",
        "params": {
          "name": "campaign_create",
          "arguments": {
            "name": "Blackbox Campaign",
            "gm_mode": "HUMAN",
            "theme_prompt": "An integration test campaign"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 3
      },
      "captures": {
        "campaign_id": [
          "result.structuredContent.id",
          "result.structured_content.id"
        ]
      }
    },
    {
      "name": "campaign_read",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 4,
        "method": "resources/read",
        "params": {
          "uri": "campaign://{{campaign_id}}"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 4,
        "result.contents[0].text|json.campaign.id": "{{campaign_id}}",
        "result.contents[0].text|json.campaign.name": "Blackbox Campaign"
      }
    },
    {
      "name": "campaign_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 5,
        "method": "resources/subscribe",
        "params": {
          "uri": "campaign://{{campaign_id}}"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 5
      }
    },
    {
      "name": "participant_list_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 6,
        "method": "resources/subscribe",
        "params": {
          "uri": "campaign://{{campaign_id}}/participants"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 6
      }
    },
    {
      "name": "participant_create",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 7,
        "method": "tools/call",
        "params": {
          "name": "participant_create",
          "arguments": {
            "campaign_id": "{{campaign_id}}",
            "display_name": "Blackbox Player",
            "role": "PLAYER",
            "controller": "HUMAN"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 7
      },
      "captures": {
        "participant_id": [
          "result.structuredContent.id",
          "result.structured_content.id"
        ]
      }
    },
    {
      "name": "participant_list_read",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 8,
        "method": "resources/read",
        "params": {
          "uri": "campaign://{{campaign_id}}/participants"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 8,
        "result.contents[0].text|json.participants[0].id": "{{participant_id}}"
      }
    },
    {
      "name": "character_list_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 9,
        "method": "resources/subscribe",
        "params": {
          "uri": "campaign://{{campaign_id}}/characters"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 9
      }
    },
    {
      "name": "character_create",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 10,
        "method": "tools/call",
        "params": {
          "name": "character_create",
          "arguments": {
            "campaign_id": "{{campaign_id}}",
            "name": "Blackbox Hero",
            "kind": "PC",
            "notes": "Owned by participant"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 10
      },
      "captures": {
        "character_id": [
          "result.structuredContent.id",
          "result.structured_content.id"
        ]
      }
    },
    {
      "name": "character_list_read",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 11,
        "method": "resources/read",
        "params": {
          "uri": "campaign://{{campaign_id}}/characters"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 11,
        "result.contents[0].text|json.characters[0].id": "{{character_id}}"
      }
    },
    {
      "name": "character_control_set",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 12,
        "method": "tools/call",
        "params": {
          "name": "character_control_set",
          "arguments": {
            "campaign_id": "{{campaign_id}}",
            "character_id": "{{character_id}}",
            "controller": "{{participant_id}}"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 12
      }
    },
    {
      "name": "session_list_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 13,
        "method": "resources/subscribe",
        "params": {
          "uri": "campaign://{{campaign_id}}/sessions"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 13
      }
    },
    {
      "name": "session_start",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 14,
        "method": "tools/call",
        "params": {
          "name": "session_start",
          "arguments": {
            "campaign_id": "{{campaign_id}}",
            "name": "Blackbox Session"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 14
      },
      "captures": {
        "session_id": [
          "result.structuredContent.id",
          "result.structured_content.id"
        ]
      }
    },
    {
      "name": "session_events_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 15,
        "method": "resources/subscribe",
        "params": {
          "uri": "session://{{session_id}}/events"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 15
      }
    },
    {
      "name": "context_subscribe",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 16,
        "method": "resources/subscribe",
        "params": {
          "uri": "context://current"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 16
      }
    },
    {
      "name": "set_context",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 17,
        "method": "tools/call",
        "params": {
          "name": "set_context",
          "arguments": {
            "campaign_id": "{{campaign_id}}",
            "session_id": "{{session_id}}",
            "participant_id": "{{participant_id}}"
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 17
      }
    },
    {
      "name": "session_action_roll",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 18,
        "method": "tools/call",
        "params": {
          "name": "session_action_roll",
          "arguments": {
            "character_id": "{{character_id}}",
            "trait": "bravery",
            "difficulty": 10,
            "modifiers": [
              {"source": "skill", "value": 2}
            ]
          }
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 18
      }
    },
    {
      "name": "session_events_read",
      "expect_status": 200,
      "request": {
        "jsonrpc": "2.0",
        "id": 19,
        "method": "resources/read",
        "params": {
          "uri": "session://{{session_id}}/events"
        }
      },
      "expect_paths": {
        "jsonrpc": "2.0",
        "id": 19,
        "result.contents[0].text|json.events[0].session_id": "{{session_id}}"
      }
    }
  ]
}
